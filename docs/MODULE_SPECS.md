# Module Specs — GM-Toolkit

## Purpose
This document provides a compact per-module reference: what each module does, its core screens, key fields, linking behavior, and print/search expectations. It exists to help implement thin vertical slices consistently without re-deciding module scope every time.

Modules are top-level in navigation and designed to be interconnected parts of a single campaign planner.

---

## Global conventions (apply to all modules)

### CRUD + archive
Every module supports:
- Create
- Read (list + detail)
- Update
- Archive (soft delete)
- Restore

Archived items:
- are hidden by default
- are selectable/linkable **only when “Show archived” is enabled**
- are clearly marked when visible

### References panel
All entity detail pages include a References panel:
- grouped by type
- shows title + small metadata
- supports preview-first behavior

### Search
- Global search includes all entities (see `docs/SEARCH_AND_TAGGING.md`)
- Per-module search:
  - matches name/title, tags, and written text (notes/free text)
  - triggers on Enter

### Printing/PDF
PDF pack generation is a first-class feature:
- Combined PDF (A4 + cards) with browser print fallback
- Print rules defined in `docs/PRINT_SPEC.md`

---

## 1) Campaign Dashboard

### Purpose
Home screen for a campaign. Provides orientation, quick access, and pack generation entry points.

### Core elements
- Campaign switcher (top bar)
- Global search (top bar)
- Export/import (top bar)
- Saving indicator (top bar + relevant forms)
- Last session summary
- Next session (entry point to prep wizard)
- Prep checklist
- Party overview
- Recently edited
- Tool quick links

### Print entry points
- Pack export/print is available:
  - from the Campaign Dashboard
  - from the Session page itself

---

## 2) Party

### Purpose
Track player characters for XP splits and quick reference.

### Fields (MVP)
- Player name
- Character name
- Class
- Level
- AC (normal, touch, flat-footed)
- HP
- Notes

### Links
- Used for XP-per-PC calculations in encounters/session packs

### Printing
- Party summary is not required in session pack (optional later)

---

## 3) NPCs

### Purpose
Store NPC notes and quick combat/stat references.

### Fields (MVP)
- Name
- Role
- Class
- Level
- Attributes (fixed object)
- Key skills (list of `{ name, bonus }`)
- Notes
- Tags

### Links
- Optional link to location
- Can be referenced by encounters and sessions

### Printing
- NPC index cards (minimal combat quick view)

---

## 4) Creatures

### Purpose
Store creatures for encounter building and stat reference.

### Fields (MVP)
- Name
- Type
- CR
- XP (computed via lookup table for MVP)
- Semi-structured stat fields (as per data model)
- Full stat block text (stored; truncated on cards)
- Link (e.g., AoN reference URL)
- Tags

### Links
- Referenced by encounters

### Printing
- Creature index cards include structured fields + truncated text

---

## 5) Encounters

### Purpose
Build encounters that are linked into sessions and printable as A4 encounter pages.

### Fields (MVP)
- Title
- Creature list + quantities
- NPC list + quantities
- Tactics
- Map reference
- Treasure notes
- XP totals:
  - total XP
  - XP per PC (based on party)

### Required links
- Encounter → creature (required for creatures used)
- Encounter → NPC (required for NPC participants)

### Printing
- One encounter per A4 page (overflow allowed)
- Must include: title, map reference, participants, tactics, treasure, XP

---

## 6) Locations

### Purpose
Store location notes with parent/child hierarchy.

### Fields (MVP)
- Name
- Parent location (optional)
- Description
- Tags (optional later; not MVP priority)

### Links
- NPC → location (optional)
- Session → location (optional)

### Printing
- Location notes may be included as session “notables” if enabled

---

## 7) Items

### Purpose
Create printable player handouts and track treasure.

### Fields (MVP)
- Name
- Description (unidentified)
- Full details (identified)
- Passphrase (generated by default; editable)
- Notes (optional)
- Tags (optional later)

### Passphrase rules
- Default: **generate thematic passphrases**
- User can edit passphrase
- Both unidentified and identified cards display the same passphrase clearly

### Printing
- TCG item cards:
  - Unidentified variant
  - Identified variant
- Pack inclusion:
  - include items explicitly selected for the session pack
  - also include items referenced via treasure notes **if linked** (implementation-dependent)

---

## 8) Session Prep (Wizard)

### Purpose
Guide the GM from “idea” to “ready to run” and output a combined PDF pack.

### Wizard step order (MVP)
1. Overview (date/title/agenda)
2. Select encounters (ordered; user can reorder)
3. Add notables (optional NPCs/Locations)
4. GM notes
5. Preview pack
6. Generate PDF

### Validation (required)
Before “Generate PDF”:
- enforce required fields
- enforce required links (session must have encounters; encounters must have participants)
- enforce encounter required content (title, map ref, participants, tactics, treasure, XP)

### Modal quick-create
From within the wizard:
- selecting entities uses a picker
- “Create new” opens a modal quick-create flow and returns to the wizard

### Printing options
- Provide an option to include/exclude “notables” in the printed pack

---

## 9) Session Review

### Purpose
Capture outcomes after the session and inform future prep.

### Fields (MVP)
- Summary
- Key moments
- Outcomes
- Rewards given out
- Information changes (free-text for MVP)
- Next hooks
- GM notes

### Links
- Session ↔ Encounter (required via session)
- Session → NPC (optional)
- Session → Location (optional)

### Printing
- Review content is not required in the session pack (optional later)

---

## Pack inclusion rules (MVP)

### Notables inclusion option
When generating a session pack, provide an option:
- Include notables (NPCs/Locations) — ON/OFF

### NPC/Creature card inclusion
Default behavior:
- Include NPC/Creature cards for entities referenced:
  - by encounters in the session
  - and by session notables (if included)

### Items inclusion
Include:
- Items explicitly selected for the pack
- Items referenced via treasure notes if the user links/selects them (or if auto-linking exists)

---

## Notes for implementation
- Use the authoritative field definitions and storage rules in `docs/DATA_MODEL.md`.
- Keep module routes consistent with hash routing and the Information Architecture doc.
- Avoid scope creep: no VTT features, no map maker/generator.
